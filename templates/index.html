<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Arenesha AI Labs | YOLOv8 Workshop</title>

  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <style>
    :root {
      --gold: #F5C079;
      --gold-hover: #B07C4D;
      --panel-bg: rgba(161,117,49,0.1);
      --panel-border: #BC8A4B;
    }

    body {
      background: linear-gradient(to right, #000000, #2F210E);
      color: white;
      font-family: Inter, system-ui, sans-serif;
    }

    .panel {
      background-color: var(--panel-bg);
      border: 1px solid var(--panel-border);
    }

    .btn-primary {
      background-color: var(--gold);
      color: black;
      padding: 0.6rem 1.4rem;
      border-radius: 0.6rem;
      font-weight: 500;
      transition: all 0.25s ease;
      width: 100%;
      max-width: 260px;
    }

    .btn-primary:hover {
      background-color: var(--gold-hover);
      transform: translateY(-1px);
    }

    input {
      background: #1F1F1F;
      border: 1px solid #3A3A3A;
      color: white;
      padding: 0.55rem;
      border-radius: 0.5rem;
      width: 100%;
    }

    .hint {
      font-size: 0.75rem;
      color: #d1d5db;
      text-align: left;
    }
  </style>
</head>

<body class="min-h-screen">

<header class="text-center py-6">
  <img src="/static/Arenesha-Logo.png" class="w-56 mx-auto">
  <p class="mt-2 tracking-widest uppercase text-sm text-gray-300">
    YOLOv8 Vision Workshop
  </p>
</header>

<main class="max-w-5xl mx-auto p-6 grid grid-cols-1 md:grid-cols-2 gap-6">

  <!-- IMAGE DETECTION -->
  <section class="panel rounded-xl p-6 text-center">
    <h2 class="text-xl font-semibold text-yellow-300 mb-4 uppercase">
      Image Detection
    </h2>

    <form id="image-form" class="space-y-4">

      <div>
        <input type="file" name="model" accept=".pt" required>
        <p class="hint mt-1">üì¶ Upload trained YOLO model (.pt file)</p>
      </div>

      <div>
        <input type="file" name="image" accept="image/*" required>
        <p class="hint mt-1">üñºÔ∏è Upload image for detection (jpg / png)</p>
      </div>

      <button class="btn-primary mx-auto block">
        Run Detection
      </button>
    </form>

    <img id="result-img"
         class="mt-6 rounded-lg border border-yellow-500 hidden max-w-full">
  </section>

  <!-- LIVE WEBCAM -->
  <section class="panel rounded-xl p-6 text-center">
    <h2 class="text-xl font-semibold text-yellow-300 mb-4 uppercase">
      Live Webcam Detection
    </h2>

    <form id="webcam-form" class="space-y-4">

      <div>
        <input type="file" name="model" accept=".pt" required>
        <p class="hint mt-1">üì¶ Upload trained YOLO model (.pt file)</p>
      </div>

      <button class="btn-primary mx-auto block">
        Start Webcam
      </button>
    </form>

    <button id="stop-btn"
            class="btn-primary mx-auto block mt-3 hidden bg-red-500">
      Stop Webcam
    </button>

    <img id="webcam-stream"
         class="mt-6 rounded-lg border border-yellow-500 hidden w-full">
  </section>

</main>

<footer class="text-center text-xs text-gray-400 mt-10 pb-6">
  ¬© 2025 AreneSha AI Labs. All rights reserved.
</footer>

<script>
document.getElementById("image-form").addEventListener("submit", async e => {
  e.preventDefault();
  const formData = new FormData(e.target);
  const res = await fetch("/run_image_inference", {
    method: "POST",
    body: formData
  });
  const data = await res.json();

  const img = document.getElementById("result-img");
  img.src = data.result_image + "?t=" + Date.now();
  img.classList.remove("hidden");
});

const webcamForm = document.getElementById("webcam-form");
const webcamImg = document.getElementById("webcam-stream");
const stopBtn = document.getElementById("stop-btn");

webcamForm.addEventListener("submit", async e => {
  e.preventDefault();
  const formData = new FormData(webcamForm);

  await fetch("/start_webcam", {
    method: "POST",
    body: formData
  });

  webcamImg.src = "/video_feed";
  webcamImg.classList.remove("hidden");
  stopBtn.classList.remove("hidden");
});

stopBtn.addEventListener("click", async () => {
  await fetch("/stop_webcam", { method: "POST" });

  webcamImg.src = "";
  webcamImg.classList.add("hidden");
  stopBtn.classList.add("hidden");
});
</script>

</body>
</html>

